<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Construct pointwise variability bands via a bootstrap — bootstrap_trendfilter • trendfiltering</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Construct pointwise variability bands via a bootstrap — bootstrap_trendfilter" />
<meta property="og:description" content="Construct pointwise variability bands via a bootstrap" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">trendfiltering</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../papers.html">Papers</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/capolitsch/trendfiltering">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Construct pointwise variability bands via a bootstrap</h1>
    <small class="dont-index">Source: <a href='https://github.com/capolitsch/trendfiltering/blob/main/R/bootstrap_trendfilter.R'><code>R/bootstrap_trendfilter.R</code></a></small>
    <div class="hidden name"><code>bootstrap_trendfilter.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Construct pointwise variability bands via a bootstrap</p>
    </div>

    <pre class="usage"><span class='fu'>bootstrap_trendfilter</span><span class='op'>(</span>
  <span class='va'>obj</span>,
  <span class='va'>bootstrap_algorithm</span>,
  level <span class='op'>=</span> <span class='fl'>0.95</span>,
  B <span class='op'>=</span> <span class='fl'>100L</span>,
  return_ensemble <span class='op'>=</span> <span class='cn'>FALSE</span>,
  prune <span class='op'>=</span> <span class='cn'>TRUE</span>,
  mc_cores <span class='op'>=</span> <span class='fu'>parallel</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/parallel/detectCores.html'>detectCores</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>obj</th>
      <td><p>An object of class <code><a href='sure_trendfilter.html'>sure_tf</a></code> or
<code><a href='cv_trendfilter.html'>cv_tf</a></code>.</p></td>
    </tr>
    <tr>
      <th>bootstrap_algorithm</th>
      <td><p>A string specifying which variation of the
bootstrap to use. One of <code><a href='https://rdrr.io/r/base/c.html'>c("nonparametric","parametric","wild")</a></code>. See
details below for recommendations on when each option is appropriate.</p></td>
    </tr>
    <tr>
      <th>level</th>
      <td><p>The level of the pointwise variability bands. Defaults to
<code>level = 0.95</code>.</p></td>
    </tr>
    <tr>
      <th>B</th>
      <td><p>The number of bootstrap samples used to estimate the pointwise
variability bands. Defaults to <code>B = 100</code>.</p></td>
    </tr>
    <tr>
      <th>return_ensemble</th>
      <td><p><script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
 Logical. If <code>TRUE</code>, the full trend
filtering bootstrap ensemble is returned as an \(n \times B\) matrix,
less any columns from post-hoc pruning (see <code>prune</code> below). Defaults to
<code>return_ensemble = FALSE</code> to save memory.</p></td>
    </tr>
    <tr>
      <th>prune</th>
      <td><p>Logical. If <code>TRUE</code>, then the trend filtering bootstrap
ensemble is examined for rare instances in which the optimization has
stopped at zero knots (likely erroneously), and removes them from the
ensemble that is used to compute the variability bands. Defaults to
<code>prune = TRUE</code>. Do not change this unless you know what you are doing!</p></td>
    </tr>
    <tr>
      <th>mc_cores</th>
      <td><p>Multi-core computing using the
<code><a href='https://rdrr.io/r/parallel/parallel-package.html'>parallel</a></code> package: The number of cores to
utilize. Defaults to the number of cores detected.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>bootstrap_tf</code>. This is a comprehensive
list containing all of the analysis important information, data, and
results:</p>
<dt>tf_standard_errors</dt><dd><p>The standard errors of the optimized trend
filtering point estimator.</p></dd>
<dt>bootstrap_lower_band</dt><dd><p>Vector of lower bounds for the pointwise
variability bands, evaluated on <code>x_eval</code>.</p></dd>
<dt>bootstrap_upper_band</dt><dd><p>Vector of upper bounds for the pointwise
variability bands, evaluated on <code>x_eval</code>.</p></dd>
<dt>bootstrap_algorithm</dt><dd><p>A string specifying which variation of the
bootstrap was used to obtain the variability bands.</p></dd>
<dt>level</dt><dd><p>The level of the pointwise variability bands.</p></dd>
<dt>B</dt><dd><p>The number of bootstrap samples used to estimate the pointwise
variability bands.</p></dd>
<dt>tf_bootstrap_ensemble</dt><dd><p>If <code>return_ensemble = TRUE</code>, the
full trend filtering bootstrap ensemble as an \(n \times B\) matrix,
less any columns from post-hoc pruning (if <code>prune = TRUE</code>). Else, this will
return <code>NULL</code>.</p></dd>
<dt>edf_boots</dt><dd><p>An integer vector of the estimated number of effective
degrees of freedom of each trend filtering bootstrap estimate. These should
all be relatively close to <code>edf_min</code> (below).</p></dd>
<dt>prune</dt><dd><p>Logical. If <code>TRUE</code>, then the trend filtering bootstrap
ensemble is examined for rare instances in which the optimization has
stopped at zero knots (likely erroneously), and removes them from the
ensemble.</p></dd>
<dt>n_pruned</dt><dd><p>The number of poorly-converged bootstrap trend filtering
estimates pruned from the ensemble.</p></dd>
<dt>n_iter_boots</dt><dd><p>Vector of the number of iterations needed for the ADMM
algorithm to converge within the given tolerance, for each bootstrap trend
filtering estimate.</p></dd>
<dt>...</dt><dd><p>Named elements inherited from <code>obj</code> --- an object either of class
<code><a href='sure_trendfilter.html'>sure_tf</a></code> or <code><a href='cv_trendfilter.html'>cv_tf</a></code>. See the relevant
function documentation for details.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Our recommendations for when to use each of the possible settings
for the <code>bootstrap_algorithm</code> argument are shown in the table below. See
<a href='https://academic.oup.com/mnras/article/492/3/4005/5704413'>
Politsch et al. (2020a)</a> for more details.</p><table class='table'>
<tr><td>Scenario</td><td>Uncertainty quantification</td></tr>
<tr><td><code>x</code> is irregularly sampled</td><td><code>bootstrap_algorithm = "nonparametric"</code></td></tr>
<tr><td><code>x</code> is regularly sampled and reciprocal variances are not available</td><td><code>bootstrap_algorithm = "wild"</code></td></tr>
<tr><td><code>x</code> is regularly sampled and reciprocal variances are available</td><td><code>bootstrap_algorithm = "parametric"</code></td></tr>
</table>


    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p><b>Companion references</b></p><ol>
<li><p>Politsch et al. (2020a).
<a href='https://academic.oup.com/mnras/article/492/3/4005/5704413'>
Trend filtering – I. A modern statistical tool for time-domain astronomy and
astronomical spectroscopy</a>. <em>MNRAS</em>, 492(3), p. 4005-4018. <br /></p></li>
<li><p>Politsch et al. (2020b).
<a href='https://academic.oup.com/mnras/article/492/3/4019/5704414'>
Trend Filtering – II. Denoising astronomical signals with varying degrees of
smoothness</a>. <em>MNRAS</em>, 492(3), p. 4019-4032.</p></li>
</ol>

<p><b>The Bootstrap and variations</b></p><ol>
<li><p>Efron and Tibshirani (1986).
<a href='https://projecteuclid.org/journals/statistical-science/volume-1/issue-1/Bootstrap-Methods-for-Standard-Errors-Confidence-Intervals-and-Other-Measures/10.1214/ss/1177013815.full'>
Bootstrap Methods for Standard Errors, Confidence Intervals, and Other
Measures of Statistical Accuracy</a>.
<em>Statistical Science</em>, 1(1), p. 54-75. <br /></p></li>
<li><p>Mammen (1993).
<a href='https://projecteuclid.org/journals/annals-of-statistics/volume-21/issue-1/Bootstrap-and-Wild-Bootstrap-for-High-Dimensional-Linear-Models/10.1214/aos/1176349025.full'>
Bootstrap and Wild Bootstrap for High Dimensional Linear Models</a>. <em>The
Annals of Statistics</em>, 21(1), p. 255-285. <br /></p></li>
<li><p>Efron (1979).
<a href='https://projecteuclid.org/journals/annals-of-statistics/volume-7/issue-1/Bootstrap-Methods-Another-Look-at-the-Jackknife/10.1214/aos/1176344552.full'>
Bootstrap Methods: Another Look at the Jackknife</a>.
<em>The Annals of Statistics</em>, 7(1), p. 1-26.</p></li>
</ol>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='sure_trendfilter.html'>sure_trendfilter()</a></code>, <code><a href='cv_trendfilter.html'>cv_trendfilter()</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>quasar_spectrum</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>spec</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span style='color: #949494;'># A tibble: 6 × 3</span>
#&gt;   log10_wavelength   flux weights
#&gt;              <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>   <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>
#&gt; <span style='color: #BCBCBC;'>1</span>             3.55  0.424  0.041<span style='text-decoration: underline;'>7</span>
#&gt; <span style='color: #BCBCBC;'>2</span>             3.55 -<span style='color: #BB0000;'>2.11</span>   0.125 
#&gt; <span style='color: #BCBCBC;'>3</span>             3.55 -<span style='color: #BB0000;'>3.78</span>   0.128 
#&gt; <span style='color: #BCBCBC;'>4</span>             3.55  3.60   0.121 
#&gt; <span style='color: #BCBCBC;'>5</span>             3.55 -<span style='color: #BB0000;'>4.89</span>   0.134 
#&gt; <span style='color: #BCBCBC;'>6</span>             3.55  1.76   0.132 </div><div class='input'>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>sure_tf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='sure_trendfilter.html'>sure_trendfilter</a></span><span class='op'>(</span><span class='va'>spec</span><span class='op'>$</span><span class='va'>log10_wavelength</span>, <span class='va'>spec</span><span class='op'>$</span><span class='va'>flux</span>, <span class='va'>spec</span><span class='op'>$</span><span class='va'>weights</span><span class='op'>)</span>
<span class='va'>opt_tf</span> <span class='op'>&lt;-</span> <span class='fu'>bootstrap_trendfilter</span><span class='op'>(</span><span class='va'>sure_tf</span>, bootstrap_algorithm <span class='op'>=</span> <span class='st'>"parametric"</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://collinpolitsch.com/'>Collin A. Politsch</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


