<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Construct pointwise variability bands via a tailored bootstrap algorithm — bootstrap_trendfilter • trendfiltering</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Construct pointwise variability bands via a tailored bootstrap algorithm — bootstrap_trendfilter" />
<meta property="og:description" content="Generate a bootstrap ensemble of trend filtering estimates in order to
quantify the uncertainty in the optimized estimate. One of three possible
bootstrap algorithms should be chosen according to the criteria in the
Details section below. Pointwise variability bands are then obtained by
passing the 'bootstrap_trendfilter' object to vbands(), along with the
desired level (e.g. level = 0.95) ." />
<meta property="og:image" content="https://capolitsch.github.io/trendfiltering/logo.svg" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">trendfiltering</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../papers.html">Papers</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/capolitsch/trendfiltering">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Construct pointwise variability bands via a tailored bootstrap algorithm</h1>
    <small class="dont-index">Source: <a href='https://github.com/capolitsch/trendfiltering/blob/main/R/bootstrapping.R'><code>R/bootstrapping.R</code></a></small>
    <div class="hidden name"><code>bootstrap_trendfilter.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Generate a bootstrap ensemble of trend filtering estimates in order to
quantify the uncertainty in the optimized estimate. One of three possible
bootstrap algorithms should be chosen according to the criteria in the
<em>Details</em> section below. Pointwise variability bands are then obtained by
passing the '<code>bootstrap_trendfilter</code>' object to <code><a href='vbands.html'>vbands()</a></code>, along with the
desired level (e.g. <code>level = 0.95</code>) .</p>
    </div>

    <pre class="usage"><span class='fu'>bootstrap_trendfilter</span><span class='op'>(</span>
  <span class='va'>obj</span>,
  algorithm <span class='op'>=</span> <span class='cn'>NULL</span>,
  B <span class='op'>=</span> <span class='fl'>100L</span>,
  x_eval <span class='op'>=</span> <span class='cn'>NULL</span>,
  lambda <span class='op'>=</span> <span class='cn'>NULL</span>,
  mc_cores <span class='op'>=</span> <span class='fu'>parallel</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/parallel/detectCores.html'>detectCores</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>4</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>obj</th>
      <td><p>An object of class '<code><a href='cv_trendfilter.html'>cv_trendfilter</a></code>' or
'<code><a href='sure_trendfilter.html'>sure_trendfilter</a></code>'.</p></td>
    </tr>
    <tr>
      <th>algorithm</th>
      <td><p>A string specifying which variation of the bootstrap to use. One of
<code><a href='https://rdrr.io/r/base/c.html'>c("nonparametric", "parametric", "wild")</a></code>. See <em>Details</em> section below for
guidelines on when each choice should be used.</p></td>
    </tr>
    <tr>
      <th>B</th>
      <td><p>The number of bootstrap samples used to estimate the pointwise variability
bands. Defaults to <code>B = 100L</code>.</p></td>
    </tr>
    <tr>
      <th>mc_cores</th>
      <td><p>Number of cores to utilize for parallel computing. Defaults to the number
of cores detected, minus 4.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional named arguments. Currently unused.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class '<code>bootstrap_trendfilter</code>' and subclass
'<code><a href='trendfilter.html'>trendfilter</a></code>'. This is a list with the elements below,
as well as all elements from <code>obj</code>.</p><dl>
<dt>x_eval</dt><dd><p>Input grid that each bootstrap trend filtering estimate was
evaluated on.</p></dd>
<dt>ensemble</dt><dd><p>The full trend filtering bootstrap ensemble as a matrix with
<code><a href='https://rdrr.io/r/base/length.html'>length(x_eval)</a></code> rows and <code>B</code> columns.</p></dd>
<dt>edf_boots</dt><dd><p>Vector of the estimated number of effective degrees of
freedom of each trend filtering bootstrap estimate.</p></dd>
<dt>n_iter_boots</dt><dd><p>Vector of the number of iterations taken by the ADMM
algorithm before reaching a stopping criterion, for each bootstrap estimate.</p></dd>
<dt>lambda_boots</dt><dd><p>Vector of the hyperparameter values used for each
bootstrap fit. In general, these are not all equal because our bootstrap
implementation instead seeks to hold the number of effective degrees of
freedom constant across all bootstrap estimates.</p></dd>
<dt>algorithm</dt><dd><p>A string specifying which variation of the bootstrap was
used to generate the ensemble.</p></dd>

</dl>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Our recommendations for when to use each of the possible settings
for the <code>algorithm</code> argument are shown in the table below. See
<a href='https://academic.oup.com/mnras/article/492/3/4005/5704413'>Politsch et al. (2020a)</a> for more details.</p><table class='table'>
<tr><td>Scenario</td><td>Uncertainty quantification</td></tr>
<tr><td><code>x</code> is unevenly sampled</td><td><code>algorithm = "nonparametric"</code></td></tr>
<tr><td><code>x</code> is evenly sampled and measurement variances for <code>y</code> are available</td><td><code>algorithm = "parametric"</code></td></tr>
<tr><td><code>x</code> is evenly sampled and measurement variances for <code>y</code> are not available</td><td><code>algorithm = "wild"</code></td></tr>
</table>



<p>For our purposes, an evenly sampled data set with some discarded pixels
(either sporadically or in large consecutive chunks) is still considered to
be evenly sampled. When the inputs are evenly sampled on a transformed scale,
we recommend transforming to that scale and carrying out the full trend
filtering analysis on that scale. See Example 2 below for a case when the
inputs are evenly sampled on the <code><a href='https://rdrr.io/r/base/Log.html'>log10(x)</a></code> scale.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
<ol>
<li><p>Politsch et al. (2020a). Trend filtering – I. A modern statistical tool
for time-domain astronomy and astronomical spectroscopy. <em>MNRAS</em>, 492(3),
p. 4005-4018.
[<a href='https://academic.oup.com/mnras/article/492/3/4005/5704413'>Publisher</a>]
[<a href='https://arxiv.org/abs/1908.07151'>arXiv</a>].</p></li>
<li><p>Politsch et al. (2020b). Trend Filtering – II. Denoising astronomical
signals with varying degrees of smoothness. <em>MNRAS</em>, 492(3), p. 4019-4032.
[<a href='https://academic.oup.com/mnras/article/492/3/4019/5704414'>Publisher</a>]
[<a href='https://arxiv.org/abs/2001.03552'>arXiv</a>].</p></li>
</ol>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='cv_trendfilter.html'>cv_trendfilter()</a></code>, <code><a href='sure_trendfilter.html'>sure_trendfilter()</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Example 1: Phase-folded light curve of an eclipsing binary star system</span>
<span class='co'>#</span>
<span class='co'># The apparent brightness over time of a star system that has two suns</span>
<span class='co'># that regularly eclipse one another from our vantage point on Earth. Here,</span>
<span class='co'># the time series is stacked according to the orbital period of the binary</span>
<span class='co'># system, with the primary eclipse occuring at `phase = 0` and the input</span>
<span class='co'># domain ranging from -0.5 to 0.5.</span>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"eclipsing_binary"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>eclipsing_binary</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span style='color: #949494;'># A tibble: 6 × 3</span>
#&gt;    phase  flux std_err
#&gt;    <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>   <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>
#&gt; <span style='color: #BCBCBC;'>1</span> -<span style='color: #BB0000;'>0.499</span> 0.938  0.010<span style='text-decoration: underline;'>2</span>
#&gt; <span style='color: #BCBCBC;'>2</span> -<span style='color: #BB0000;'>0.498</span> 0.930  0.010<span style='text-decoration: underline;'>2</span>
#&gt; <span style='color: #BCBCBC;'>3</span> -<span style='color: #BB0000;'>0.496</span> 0.944  0.010<span style='text-decoration: underline;'>2</span>
#&gt; <span style='color: #BCBCBC;'>4</span> -<span style='color: #BB0000;'>0.494</span> 0.963  0.010<span style='text-decoration: underline;'>2</span>
#&gt; <span style='color: #BCBCBC;'>5</span> -<span style='color: #BB0000;'>0.494</span> 0.934  0.010<span style='text-decoration: underline;'>2</span>
#&gt; <span style='color: #BCBCBC;'>6</span> -<span style='color: #BB0000;'>0.494</span> 0.949  0.010<span style='text-decoration: underline;'>2</span></div><div class='input'>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>eclipsing_binary</span><span class='op'>$</span><span class='va'>phase</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='va'>eclipsing_binary</span><span class='op'>$</span><span class='va'>flux</span>
<span class='va'>weights</span> <span class='op'>&lt;-</span> <span class='fl'>1</span> <span class='op'>/</span> <span class='va'>eclipsing_binary</span><span class='op'>$</span><span class='va'>std_err</span><span class='op'>^</span><span class='fl'>2</span>

<span class='va'>cv_tf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='cv_trendfilter.html'>cv_trendfilter</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, <span class='va'>weights</span>, max_iter <span class='op'>=</span> <span class='fl'>1e4</span>, obj_tol <span class='op'>=</span> <span class='fl'>1e-6</span><span class='op'>)</span>
<span class='va'>boot_tf</span> <span class='op'>&lt;-</span> <span class='fu'>bootstrap_trendfilter</span><span class='op'>(</span><span class='va'>cv_tf</span>, <span class='st'>"nonparametric"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: all scheduled cores encountered errors in user code</span></div><div class='output co'>#&gt; <span class='error'>Error in par_out[[X]][["tf_estimate_boot"]]: subscript out of bounds</span></div><div class='input'>

<span class='co'># Example 2: The "Lyman-alpha forest" in the spectrum of a distant quasar</span>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"quasar_spectrum"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>quasar_spectrum</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span style='color: #949494;'># A tibble: 6 × 3</span>
#&gt;   log10_wavelength   flux weights
#&gt;              <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>   <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>
#&gt; <span style='color: #BCBCBC;'>1</span>             3.55  0.424  0.041<span style='text-decoration: underline;'>7</span>
#&gt; <span style='color: #BCBCBC;'>2</span>             3.55 -<span style='color: #BB0000;'>2.11</span>   0.125 
#&gt; <span style='color: #BCBCBC;'>3</span>             3.55 -<span style='color: #BB0000;'>3.78</span>   0.128 
#&gt; <span style='color: #BCBCBC;'>4</span>             3.55  3.60   0.121 
#&gt; <span style='color: #BCBCBC;'>5</span>             3.55 -<span style='color: #BB0000;'>4.89</span>   0.134 
#&gt; <span style='color: #BCBCBC;'>6</span>             3.55  1.76   0.132 </div><div class='input'>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>quasar_spectrum</span><span class='op'>$</span><span class='va'>log10_wavelength</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='va'>quasar_spectrum</span><span class='op'>$</span><span class='va'>flux</span>
<span class='va'>weights</span> <span class='op'>&lt;-</span> <span class='va'>quasar_spectrum</span><span class='op'>$</span><span class='va'>weights</span>

<span class='va'>sure_tf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='sure_trendfilter.html'>sure_trendfilter</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, <span class='va'>weights</span><span class='op'>)</span>
<span class='va'>boot_tf</span> <span class='op'>&lt;-</span> <span class='fu'>bootstrap_trendfilter</span><span class='op'>(</span><span class='va'>sure_tf</span>, <span class='st'>"parametric"</span><span class='op'>)</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Collin A. Politsch.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


