<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Optimize the trend filtering hyperparameter by V-fold cross validation — cv_trendfilter • trendfiltering</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>


<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Optimize the trend filtering hyperparameter by V-fold cross validation — cv_trendfilter" />
<meta property="og:description" content="
 For every candidate hyperparameter value, estimate the trend
filtering model's out-of-sample error by V-fold cross validation. CV
error curves are returned for four of the most common regression loss
metrics, as well as observation-weighted versions. Custom loss functions may
also be passed to the loss_funcs argument. See the details section for
definitions of the internal loss functions, and for guidelines on when
cv_trendfilter() should be used versus sure_trendfilter()." />
<meta property="og:image" content="https://capolitsch.github.io/trendfiltering/logo.svg" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">trendfiltering</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>

  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../papers.html">Papers</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/capolitsch/trendfiltering">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>

    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Optimize the trend filtering hyperparameter by <em>V</em>-fold cross validation</h1>
    <small class="dont-index">Source: <a href='https://github.com/capolitsch/trendfiltering/blob/main/R/cv_trendfilter.R'><code>R/cv_trendfilter.R</code></a></small>
    <div class="hidden name"><code>cv_trendfilter.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
 For every candidate hyperparameter value, estimate the trend
filtering model's out-of-sample error by <em>V</em>-fold cross validation. CV
error curves are returned for four of the most common regression loss
metrics, as well as observation-weighted versions. Custom loss functions may
also be passed to the <code>loss_funcs</code> argument. See the details section for
definitions of the internal loss functions, and for guidelines on when
<code>cv_trendfilter()</code> should be used versus <code><a href='sure_trendfilter.html'>sure_trendfilter()</a></code>.</p>
    </div>

    <pre class="usage"><span class='fu'>cv_trendfilter</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>y</span>,
  <span class='va'>weights</span>,
  k <span class='op'>=</span> <span class='fl'>2L</span>,
  nlambdas <span class='op'>=</span> <span class='fl'>250L</span>,
  V <span class='op'>=</span> <span class='fl'>10L</span>,
  mc_cores <span class='op'>=</span> <span class='va'>V</span>,
  <span class='va'>loss_funcs</span>,
  <span class='va'>fold_ids</span>,
  <span class='va'>optimization_params</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>Vector of observed values for the input variable.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>Vector of observed values for the output variable.</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>(Optional) Weights for the observed outputs, defined as the
reciprocal variance of the additive noise that contaminates the output
signal. When the noise is expected to have an equal variance
\(\sigma^2\) for all observations, a scalar may be passed to <code>weights</code>,
namely <code>weights = </code>\(1/\sigma^2\). Otherwise, <code>weights</code> must be a vector
with the same length as <code>x</code> and <code>y</code>.</p></td>
    </tr>
    <tr>
      <th>k</th>
      <td><p>Degree of the polynomials that make up the piecewise-polynomial
trend filtering estimate. Defaults to <code>k = 2</code> (i.e. a piecewise quadratic
estimate). Must be one of <code>k = 0,1,2</code>. Higher order polynomials are
disallowed since their smoothness is indistinguishable from <code>k = 2</code> and
their use can lead to instability in the convex optimization.</p></td>
    </tr>
    <tr>
      <th>nlambdas</th>
      <td><p>Number of hyperparameter values to test during validation.
Defaults to <code>nlambdas = 250</code>. The hyperparameter grid is internally
constructed to span the full trend filtering model space (which is bookended
by a global polynomial solution and an interpolating solution), with
<code>nlambdas</code> controlling the granularity of the hyperparameter grid.</p></td>
    </tr>
    <tr>
      <th>V</th>
      <td><p>Number of folds that the data are partitioned into for <em>V</em>-fold
cross validation. Defaults to <code>V = 10</code>.</p></td>
    </tr>
    <tr>
      <th>mc_cores</th>
      <td><p>Multi-core computing using the
<code><a href='https://rdrr.io/r/parallel/parallel-package.html'>parallel</a></code> R package: The number of cores to
utilize. Defaults to the number of cross validation folds, <code>mc_cores = V</code>.
If the value passed to <code>mc_cores</code> exceeds the number of cores available on
the machine, <code>mc_cores</code> is internally updated to
<code>mc_cores = parallel::detectCores()</code>.</p></td>
    </tr>
    <tr>
      <th>loss_funcs</th>
      <td><p>(Optional) A named list of one or more functions, with each
defining a loss function to be evaluated on held-out folds during cross
validation. By default, <code>cv_trendfilter()</code> will automatically compute and
return CV error curves for 9 common regression loss functions (see the
Details section below). Therefore, the <code>loss_funcs</code> argument need only be
used in order to define loss functions that are not among these 9 choices.</p>
<p>When defining custom loss functions, each function within the named list
passed to <code>loss_funcs</code> should take three vector arguments --- <code>y</code>,
<code>tf_estimate</code>, and <code>weights</code> --- and return a single scalar value for the
validation error. For example, if I wanted a CV error curve based on a
weighted median of the absolute errors to be computed, I would pass the list
below to <code>loss_funcs</code>:<div class="sourceCode r"></p><pre><span class='va'>MedAE</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>tf_estimate</span>, <span class='va'>y</span>, <span class='va'>weights</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'>matrixStats</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/matrixStats/man/weightedMedian.html'>weightedMedian</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>tf_estimate</span> <span class='op'>-</span> <span class='va'>y</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>weights</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>MedAE <span class='op'>=</span> <span class='va'>MedAE</span><span class='op'>)</span>
</pre><p></div></p></td>
    </tr>
    <tr>
      <th>fold_ids</th>
      <td><p>(Optional) An integer vector defining a custom partition of
the data for cross validation. <code>fold_ids</code> must have the same length as <code>x</code>
and <code>y</code>, and only contain values in the set <code>1:V</code>.</p></td>
    </tr>
    <tr>
      <th>optimization_params</th>
      <td><p>(Optional) A named list of parameter values to be
passed to the trend filtering ADMM algorithm of
<a href='http://www.stat.cmu.edu/~ryantibs/papers/fasttf.pdf'>Ramdas and Tibshirani (2016)</a>, which is implemented in
the <code>glmgen</code> R package. See the <code><a href='https://rdrr.io/pkg/glmgen/man/trendfilter.control.list.html'>glmgen::trendfilter.control.list()</a></code>
documentation for a full list of the algorithm's parameters. The default
parameter choices will almost always suffice, but when adjustments do need to
be made, one can do so without any technical understanding of the ADMM
algorithm. In particular, the four parameter descriptions below should serve
as sufficient working knowledge.</p><dl>
<dt><code>obj_tol</code></dt><dd><p>A stopping threshold for the ADMM algorithm. If the relative
change in the algorithm's cost functional between two consecutive steps is
less than <code>obj_tol</code>, the algorithm terminates. The algorithm's termination
can also result from it reaching the maximum tolerable iterations set
by the <code>max_iter</code> parameter below. The <code>obj_tol</code> parameter defaults to
<code>obj_tol = 1e-10</code>. The <code>cost_functional</code> vector returned within the
<code><a href='sure_trendfilter.html'>sure_trendfilter()</a></code> output gives the relative change in the trend filtering
cost functional over the algorithm's final iteration, for every candidate
hyperparameter value.</p></dd>
<dt><code>max_iter</code></dt><dd><p>Maximum number of ADMM iterations that we will tolerate.
Defaults to <code>max_iter = length(y)</code>. The actual number of iterations performed
by the algorithm, for every candidate hyperparameter value, is returned in
the <code>n_iter</code> vector within the <code><a href='sure_trendfilter.html'>sure_trendfilter()</a></code> output. If any of the
elements of <code>n_iter</code> are equal to <code>max_iter</code>, the tolerance defined by
<code>obj_tol</code> has not been attained and <code>max_iter</code> may need to be increased.</p></dd>
<dt><code>thinning</code></dt><dd><p>Logical. If <code>thinning = TRUE</code>, then the data are
preprocessed so that a smaller data set is used to fit the trend filtering
estimate, which will ease the ADMM algorithm's convergence. This can be
very useful when, for example, a signal is so well-sampled that very little
additional information / predictive accuracy is gained by fitting the trend
filtering estimate on the full data set, compared to only fitting on some
subset of it. See the <code>cv_trendfilter()</code> examples for a case study of this
nature. When nothing is passed to <code>thinning</code>, the algorithm will
automatically detect whether thinning should be applied. This preprocessing
procedure is controlled by the <code>x_tol</code> parameter below.</p></dd>
<dt><code>x_tol</code></dt><dd><p>Controls the automatic detection of when thinning should be
applied to the data. If we make bins of size <code>x_tol</code> and find at least two
elements of <code>x</code> that fall within the same bin, then the data is thinned.</p></dd>
</dl></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>'cv_tf'</code>. This is a list with the following
elements:</p><dl>
<dt><code>lambdas</code></dt><dd><p>Vector of candidate hyperparameter values (always returned
in descending order).</p></dd>
<dt><code>edfs</code></dt><dd><p>Number of effective degrees of freedom in the trend filtering
estimator, for every candidate hyperparameter value in <code>lambdas</code>.</p></dd>
<dt><code>errors</code></dt><dd><p>A named list of vectors, with each representing the
CV error curve for every loss function in <code>loss_funcs</code> (see below).</p></dd>
<dt><code>se_errors</code></dt><dd><p>Standard errors for the <code>errors</code>, within a named list of
the same structure.</p></dd>
<dt><code>lambda_min</code></dt><dd><p>A named vector with length equal to <code><a href='https://rdrr.io/r/base/length.html'>length(errors)</a></code>,
containing the hyperparameter value that minimizes the CV error curve, for
every loss function in <code>loss_funcs</code>.</p></dd>
<dt><code>lambda_1se</code></dt><dd><p>A named vector with length equal to <code><a href='https://rdrr.io/r/base/length.html'>length(errors)</a></code>,
containing the "1-standard-error rule" hyperparameter, for every loss
function in <code>loss_funcs</code>. The "1-standard-error rule" hyperparameter is the
largest hyperparameter value in <code>lambdas</code> (corresponding to the smoothest
trend filtering estimate) that has a CV error within one standard error of
<code><a href='https://rdrr.io/r/base/Extremes.html'>min(errors)</a></code>. It serves as an Occam's razor-like heuristic. More precisely,
given two models with approximately equal performance (in terms of some loss
function), it may be wise to opt for the simpler model, i.e. the model with
the larger hyperparameter / fewer effective degrees of freedom.</p></dd>
<dt><code>edf_min</code></dt><dd><p>A named vector with length equal to <code><a href='https://rdrr.io/r/base/length.html'>length(errors)</a></code>,
containing the number of effective degrees of freedom in the trend filtering
estimator that minimizes the CV error curve, for every loss function in
<code>loss_funcs</code>.</p></dd>
<dt><code>edf_1se</code></dt><dd><p>A named vector with length equal to <code><a href='https://rdrr.io/r/base/length.html'>length(errors)</a></code>,
containing the number of effective degrees of freedom in the
"1-standard-error rule" trend filtering estimator, for every loss function in
<code>loss_funcs</code>.</p></dd>
<dt><code>i_min</code></dt><dd><p>A named vector with length equal to <code><a href='https://rdrr.io/r/base/length.html'>length(errors)</a></code>,
containing the index of <code>lambdas</code> that minimizes the CV error curve, for
every loss function in <code>loss_funcs</code>.</p></dd>
<dt><code>i_1se</code></dt><dd><p>A named vector with length equal to <code><a href='https://rdrr.io/r/base/length.html'>length(errors)</a></code>,
containing the index of <code>lambdas</code> that gives the "1-standard-error rule"
hyperparameter value, for every loss function in <code>loss_funcs</code>..</p></dd>
<dt><code>loss_funcs</code></dt><dd><p>A named list of functions that defines all loss functions
evaluated during cross validation.</p></dd>
<dt><code>cost_functional</code></dt><dd><p>The relative change in the cost functional over the
ADMM algorithm's final iteration, for every candidate hyperparameter in
<code>lambdas</code>.</p></dd>
<dt><code>n_iter</code></dt><dd><p>Total number of iterations taken by the ADMM algorithm, for
every candidate hyperparameter in <code>lambdas</code>. If an element of <code>n_iter</code>
is exactly equal to <code>tf_model$admm_params$max_iter</code>, then the ADMM algorithm
stopped before reaching the objective tolerance
<code>tf_model$admm_params$obj_tol</code>. In these situations, you may need to increase
the maximum number of tolerable iterations via the
<code>optimization_params$max_iter</code> argument of <code>cv_trendfilter()</code> in order to
ensure that the trend filtering solution has converged to satisfactory
precision.</p></dd>
<dt><code>V</code></dt><dd><p>The number of folds the data were split into for cross
validation.</p></dd>
<dt><code>tf_model</code></dt><dd><p>A list of objects that is used internally by other
functions that operate on the <code>cv_trendfilter()</code> output.</p></dd>

</dl>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Our recommendations for when to use <code>cv_trendfilter()</code> versus
<code><a href='sure_trendfilter.html'>sure_trendfilter()</a></code> are summarized in the table below. See Section 3.5 of
<a href='https://arxiv.org/abs/1908.07151'>Politsch et al. (2020a)</a> for more details.</p><table class='table'>
<tr><td>Scenario</td><td>Hyperparameter optimization</td></tr>
<tr><td><code>x</code> is unevenly sampled</td><td><code>cv_trendfilter()</code></td></tr>
<tr><td><code>x</code> is evenly sampled and reciprocal variances are not available</td><td><code>cv_trendfilter()</code></td></tr>
<tr><td><code>x</code> is evenly sampled and reciprocal variances are available</td><td><code><a href='sure_trendfilter.html'>sure_trendfilter()</a></code></td></tr>
</table>



<p>For our purposes, an evenly sampled data set with some discarded pixels
(either sporadically or in large consecutive chunks) is still considered to
be evenly sampled. When <code>x</code> is evenly sampled on a transformed scale, we
recommend transforming to that scale and carrying out the full trend
filtering analysis on that scale. See the <code><a href='sure_trendfilter.html'>sure_trendfilter()</a></code> examples for
a case when the inputs are evenly sampled on the <code><a href='https://rdrr.io/r/base/Log.html'>log10(x)</a></code> scale.</p>
<p>The following loss functions are automatically computed during cross
validation and their CV error curves are returned within the <code>errors</code>
list of the <code>'cv_tf'</code> output object.</p>
<ol>
<li><p>Mean absolute deviations error: \[\text{MAE}(\lambda) =
\frac{1}{n} \sum_{i=1}^{n}|Y_i - \hat{f}(x_i; \lambda)|\]</p></li>
<li><p>Weighted mean absolute deviations error:
\[\text{WMAE}(\lambda) = \sum_{i=1}^{n}
|Y_i - \hat{f}(x_i; \lambda)|\frac{\sqrt{w_i}}{\sum_j\sqrt{w_j}}\]</p></li>
<li><p>Mean-squared error: \[\text{MSE}(\lambda) = \frac{1}{n}
\sum_{i=1}^{n} |Y_i - \hat{f}(x_i; \lambda)|^2\]</p></li>
<li><p>Weighted mean-squared error: \[\text{WMSE}(\lambda)
= \sum_{i=1}^{n}|Y_i - \hat{f}(x_i; \lambda)|^2\frac{w_i}{\sum_jw_j}\]</p></li>
<li><p>log-cosh error: \[\text{logcosh}(\lambda) = \frac{1}{n}
\sum_{i=1}^{n} \log\left(\cosh\left(Y_i - \hat{f}(x_i; \lambda)\right)\right)\]</p></li>
<li><p>Weighted log-cosh error: \[\text{wlogcosh}(\lambda) =
\sum_{i=1}^{n}
\log\left(\cosh\left((Y_i - \hat{f}(x_i; \lambda))\sqrt{w_i}\right)\right)\]</p></li>
<li><p>Huber loss: \[\text{Huber}(\lambda) =
\frac{1}{n}\sum_{i=1}^{n}L_{\delta}(Y_i; \lambda)\]
\[\text{where}\;\;\;\;L_{\delta}(Y_i; \lambda) = \cases{
|Y_i - \hat{f}(x_i; \lambda)|^2, &
$|Y_i - \hat{f}(x_i; \lambda)| \leq \delta$ \cr
2\delta|Y_i - \hat{f}(x_i; \lambda)| - \delta^2, &
$|Y_i - \hat{f}(x_i; \lambda)| > \delta$}\]</p></li>
<li><p>Weighted Huber loss: \[\text{wHuber}(\lambda) =
\sum_{i=1}^{n}L_{\delta}(Y_i; \lambda)\]
\[\text{where}\;\;\;\;L_{\delta}(Y_i; \lambda) = \cases{
|Y_i - \hat{f}(x_i; \lambda)|^2w_i, &
$|Y_i - \hat{f}(x_i; \lambda)|\sqrt{w_i} \leq \delta$ \cr
2\delta|Y_i - \hat{f}(x_i; \lambda)|\sqrt{w_i} -
\delta^2, & $|Y_i - \hat{f}(x_i; \lambda)|\sqrt{w_i} > \delta$}\]</p></li>
<li><p>Mean-squared logarithmic error: \[\text{MSLE}(\lambda) =
\frac{1}{n}\sum_{i=1}^{n}
\left|\log(Y_i + 1) - \log(\hat{f}(x_i; \lambda) + 1)\right|\]</p></li>
</ol><p>where \(w_i:=\) <code>weights[i]</code>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p><b>Companion references</b></p><ol>
<li><p>Politsch et al. (2020a).
<a href='https://academic.oup.com/mnras/article/492/3/4005/5704413'>Trend filtering – I. A modern statistical tool for time-domain astronomy and astronomical spectroscopy</a>. <em>MNRAS</em>,
492(3), p. 4005-4018. [<a href='https://arxiv.org/abs/1908.07151'>arXiv</a>]. <br /></p></li>
<li><p>Politsch et al. (2020b).
<a href='https://academic.oup.com/mnras/article/492/3/4019/5704414'>Trend Filtering – II. Denoising astronomical signals with varying degrees of smoothness</a>. <em>MNRAS</em>,
492(3), p. 4019-4032. [<a href='https://arxiv.org/abs/2001.03552'>arXiv</a>].</p></li>
</ol>

<p><b>Cross validation</b></p><ol>
<li><p>Hastie, Tibshirani, and Friedman (2009).
<a href='https://web.stanford.edu/~hastie/ElemStatLearn/printings/ESLII_print12_toc.pdf'>The Elements of Statistical Learning: Data Mining, Inference, and Prediction</a>.
2nd edition. Springer Series in Statistics. (See Sections 7.10 and 7.12).</p></li>
</ol>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='sure_trendfilter.html'>sure_trendfilter()</a></code>, <code><a href='bootstrap_trendfilter.html'>bootstrap_trendfilter()</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>eclipsing_binary</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>EB</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span style='color: #949494;'># A tibble: 6 × 3</span>
#&gt;    phase  flux std_err
#&gt;    <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>   <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>
#&gt; <span style='color: #BCBCBC;'>1</span> -<span style='color: #BB0000;'>0.499</span> 0.938  0.010<span style='text-decoration: underline;'>2</span>
#&gt; <span style='color: #BCBCBC;'>2</span> -<span style='color: #BB0000;'>0.498</span> 0.930  0.010<span style='text-decoration: underline;'>2</span>
#&gt; <span style='color: #BCBCBC;'>3</span> -<span style='color: #BB0000;'>0.496</span> 0.944  0.010<span style='text-decoration: underline;'>2</span>
#&gt; <span style='color: #BCBCBC;'>4</span> -<span style='color: #BB0000;'>0.494</span> 0.963  0.010<span style='text-decoration: underline;'>2</span>
#&gt; <span style='color: #BCBCBC;'>5</span> -<span style='color: #BB0000;'>0.494</span> 0.934  0.010<span style='text-decoration: underline;'>2</span>
#&gt; <span style='color: #BCBCBC;'>6</span> -<span style='color: #BB0000;'>0.494</span> 0.949  0.010<span style='text-decoration: underline;'>2</span></div><div class='input'>
<span class='va'>cv_tf</span> <span class='op'>&lt;-</span> <span class='fu'>cv_trendfilter</span><span class='op'>(</span>
  x <span class='op'>=</span> <span class='va'>EB</span><span class='op'>$</span><span class='va'>phase</span>,
  y <span class='op'>=</span> <span class='va'>EB</span><span class='op'>$</span><span class='va'>flux</span>,
  weights <span class='op'>=</span> <span class='fl'>1</span> <span class='op'>/</span> <span class='va'>EB</span><span class='op'>$</span><span class='va'>std_err</span><span class='op'>^</span><span class='fl'>2</span>,
  optimization_params <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    max_iter <span class='op'>=</span> <span class='fl'>1e4</span>,
    obj_tol <span class='op'>=</span> <span class='fl'>1e-6</span>,
    thinning <span class='op'>=</span> <span class='cn'>TRUE</span>
  <span class='op'>)</span>
<span class='op'>)</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Collin A. Politsch.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>




  </body>
</html>


